<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>AWS VPC Lab | Interactive Labs</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="style.css">
  <style>
    /* Lab-specific styles override sidebar/main-content layout */
    .lab-container {
      margin-left: 270px;
      padding: 40px 20px;
      min-height: 100vh;
      background: transparent;
    }
    @media (max-width: 800px) {
      .lab-container {
        margin-left: 0;
        padding: 20px 5vw;
      }
    }
  </style>
</head>
<body>
  <div class="sidebar">
    <div class="logo-container">
      <img src="image1" alt="Terraform Academy Logo" class="logo" />
    </div>
    <h2>Interactive Labs</h2>
    <ul>
      <li><a href="index.html">Home</a></li>
      <li><a href="page1.html" class="active">AWS VPC Lab</a></li>
      <li><a href="page2.html">Custom Page 2</a></li>
    </ul>
  </div>
  <div class="lab-container">
    <div class="container">
      <div class="header">
        <h1>AWS VPC Lab</h1>
        <button onclick="hideInstructions()">Hide Instructions</button>
      </div>
      <div class="main-content">
        <div class="instructions" id="instructions">
          <h2>Create a VPC in AWS</h2>
          <p>In the "Code Editor" tab, open the <code>vpc.tf</code> file.</p>
          <p>Your task: Add resources to create a VPC with a CIDR block of <code>10.0.0.0/16</code>, a subnet with a CIDR block of <code>10.0.1.0/24</code>, an internet gateway attached to the VPC, a route table with a route to the internet gateway, and an association between the subnet and the route table.</p>
        </div>
        <div class="editor-terminal">
          <div class="workspace">
            <h3>WORKSTATION</h3>
            <div class="file-tree">
              <ul>
                <li>üìÅ /root/learn-terraform-aws-vpc</li>
                <ul>
                  <li class="file" onclick="loadFile('provider.tf')">üìÑ provider.tf</li>
                  <li class="file" onclick="loadFile('vpc.tf')">üìÑ vpc.tf</li>
                </ul>
              </ul>
            </div>
          </div>
          <div class="editor-section">
            <h3>Code Editor</h3>
            <textarea id="editor" spellcheck="false"></textarea>
          </div>
          <div class="terminal-section">
            <h3>Terminal</h3>
            <textarea id="terminal" readonly>
Initializing lab environment...
Terraform initialized successfully.
            </textarea>
          </div>
        </div>
      </div>
      <div class="button-group">
        <button class="check-btn" onclick="checkCode()">Check</button>
        <button class="clear-btn" onclick="clearTerminal()">Clear Terminal</button>
        <button class="check-answer-btn" onclick="checkAnswer()">Check Answer</button>
        <button class="restart-btn" onclick="restartLab()">Restart</button>
      </div>
    </div>
  </div>
  <script>
    const editor = document.getElementById('editor');
    const terminal = document.getElementById('terminal');
    const instructions = document.getElementById('instructions');
    const initialFiles = {
      'provider.tf': `provider "aws" {
  region = "us-east-1"
}`,
      'vpc.tf': `# Define your VPC resources here
`
    };
    let files = {...initialFiles};
    const solution = `resource "aws_vpc" "main" {
  cidr_block = "10.0.0.0/16"
}

resource "aws_subnet" "public" {
  vpc_id     = aws_vpc.main.id
  cidr_block = "10.0.1.0/24"
}

resource "aws_internet_gateway" "igw" {
  vpc_id = aws_vpc.main.id
}

resource "aws_route_table" "public" {
  vpc_id = aws_vpc.main.id

  route {
    cidr_block = "0.0.0.0/0"
    gateway_id = aws_internet_gateway.igw.id
  }
}

resource "aws_route_table_association" "public_assoc" {
  subnet_id      = aws_subnet.public.id
  route_table_id = aws_route_table.public.id
}`;
    function loadFile(filename) {
      editor.value = files[filename];
      editor.dataset.file = filename
    }
    function hideInstructions() {
      instructions.classList.toggle('hidden');
      const btn = document.querySelector('.header button');
      btn.textContent = instructions.classList.contains('hidden') ? 'Show Instructions' : 'Hide Instructions'
    }
    function checkCode() {
      const code = editor.value.trim();
      let terminalOutput = terminal.value + '\n\nChecking your code...\n';
      if (editor.dataset.file !== 'vpc.tf') {
        terminalOutput += 'Error: Please edit vpc.tf to add the required resources.';
        terminal.value = terminalOutput;
        return
      }
      if (code.includes('aws_vpc') && code.includes('aws_subnet') && code.includes('aws_internet_gateway') && code.includes('aws_route_table') && code.includes('aws_route_table_association')) {
        if (code.includes('10.0.0.0/16') && code.includes('10.0.1.0/24') && code.includes('0.0.0.0/0')) {
          terminalOutput += 'Success! Your Terraform code is correct.\nApplying configuration...\nVPC created successfully.'
        } else {
          terminalOutput += 'Error: Your code is incomplete. Ensure the VPC has CIDR 10.0.0.0/16, subnet has CIDR 10.0.1.0/24, and route table routes to 0.0.0.0/0 via the internet gateway.'
        }
      } else {
        terminalOutput += 'Error: Missing required resources. Please define aws_vpc, aws_subnet, aws_internet_gateway, aws_route_table, and aws_route_table_association.'
      }
      terminal.value = terminalOutput;
      terminal.scrollTop = terminal.scrollHeight
    }
    function clearTerminal() {
      terminal.value = 'Terminal cleared.\nInitializing lab environment...\nTerraform initialized successfully.';
      terminal.scrollTop = terminal.scrollHeight
    }
    function checkAnswer() {
      if (editor.dataset.file !== 'vpc.tf') {
        loadFile('vpc.tf')
      }
      editor.value = solution;
      terminal.value += '\n\nSolution displayed in the editor.\nYou can now check the code or modify it as needed.';
      terminal.scrollTop = terminal.scrollHeight
    }
    function restartLab() {
      files = {...initialFiles};
      loadFile('provider.tf');
      terminal.value = 'Initializing lab environment...\nTerraform initialized successfully.';
      terminal.scrollTop = terminal.scrollHeight;
      if (instructions.classList.contains('hidden')) {
        hideInstructions()
      }
      terminal.value += '\n\nLab restarted. All changes have been reset.';
      terminal.scrollTop = terminal.scrollHeight
    }
    loadFile('provider.tf')
  </script>
</body>
</html>
